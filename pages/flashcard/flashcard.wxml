<!--pages/flashcard/flashcard.wxml-->
<view class="flashcard-container">
  <!-- é¡¶éƒ¨å¯¼èˆªæ  -->
  <view class="nav-bar">
    <view class="nav-left" bindtap="onBack">
      <text class="nav-icon">â†</text>
      <text class="nav-text">è¿”å›</text>
    </view>
    <view class="nav-center">
      <text class="nav-title">é—ªå¡æ¨¡å¼</text>
    </view>
    <view class="nav-right" bindtap="onShowSettings">
      <text class="nav-icon">âš™ï¸</text>
    </view>
  </view>

  <!-- å­¦ä¹ è¿›åº¦ -->
  <view class="progress-section">
    <view class="progress-info">
      <text class="progress-text">{{currentIndex + 1}} / {{totalWords}}</text>
      <text class="progress-percentage">{{progressPercentage}}%</text>
    </view>
    <view class="progress-bar">
      <view class="progress-fill" style="width: {{progressPercentage}}%"></view>
    </view>
  </view>

  <!-- å•è¯å¡ç‰‡åŒºåŸŸ -->
  <view class="card-container">
    <view class="card {{isFlipped ? 'flipped' : ''}}" bindtap="onFlipCard">
      <!-- æ­£é¢ - è‹±æ–‡å•è¯ -->
      <view class="card-front">
        <view class="word-main">
          <text class="word-text">{{currentWord.word}}</text>
          <text class="phonetic">{{currentWord.phonetic}}</text>
        </view>
        <view class="word-meta">
          <text class="part-of-speech">{{currentWord.partOfSpeech}}</text>
          <view class="difficulty-badge difficulty-{{currentWord.difficulty}}">
            <text>{{currentWord.difficultyText}}</text>
          </view>
        </view>
        <view class="flip-hint">
          <text>ç‚¹å‡»ç¿»è½¬æŸ¥çœ‹é‡Šä¹‰</text>
        </view>
      </view>

      <!-- èƒŒé¢ - ä¸­æ–‡é‡Šä¹‰ -->
      <view class="card-back">
        <view class="meaning-section">
          <text class="meaning-text">{{currentWord.meaning}}</text>
        </view>
        <view class="example-section">
          <view class="example-item">
            <text class="example-label">ä¾‹å¥ï¼š</text>
            <text class="example-english">{{currentWord.example.english}}</text>
          </view>
          <view class="example-item">
            <text class="example-chinese">{{currentWord.example.chinese}}</text>
          </view>
        </view>
        <view class="flip-hint">
          <text>å†æ¬¡ç‚¹å‡»è¿”å›æ­£é¢</text>
        </view>
      </view>
    </view>

    <!-- å‘éŸ³æŒ‰é’® -->
    <view class="pronunciation-btn" bindtap="onPlayPronunciation">
      <text class="pronunciation-icon">ğŸ”Š</text>
      <text class="pronunciation-text">å‘éŸ³</text>
    </view>
  </view>

  <!-- è®°å¿†å¼ºåº¦è¯„ä¼° -->
  <view class="assessment-section">
    <view class="assessment-title">
      <text>è¿™ä¸ªå•è¯ä½ æŒæ¡å¾—å¦‚ä½•ï¼Ÿ</text>
    </view>
    <view class="assessment-buttons">
      <view class="assessment-btn difficulty" bindtap="onAssessment" data-level="1">
        <text class="btn-icon">ğŸ˜°</text>
        <text class="btn-text">ä¸è®¤è¯†</text>
        <text class="btn-desc">å®Œå…¨ä¸ä¼š</text>
      </view>
      <view class="assessment-btn normal" bindtap="onAssessment" data-level="2">
        <text class="btn-icon">ğŸ¤”</text>
        <text class="btn-text">æœ‰å°è±¡</text>
        <text class="btn-desc">æƒ³ä¸€æƒ³æ‰çŸ¥é“</text>
      </view>
      <view class="assessment-btn easy" bindtap="onAssessment" data-level="3">
        <text class="btn-icon">ğŸ˜Š</text>
        <text class="btn-text">å¾ˆç†Ÿæ‚‰</text>
        <text class="btn-desc">ä¸€çœ‹å°±çŸ¥é“</text>
      </view>
      <view class="assessment-btn master" bindtap="onAssessment" data-level="4">
        <text class="btn-icon">ğŸ¯</text>
        <text class="btn-text">å·²æŒæ¡</text>
        <text class="btn-desc">å®Œå…¨æŒæ¡</text>
      </view>
    </view>
  </view>

  <!-- æ“ä½œæŒ‰é’® -->
  <view class="action-buttons">
    <view class="action-btn secondary" bindtap="onPrevious" wx:if="{{currentIndex > 0}}">
      <text>ä¸Šä¸€ä¸ª</text>
    </view>
    <view class="action-btn primary" bindtap="onNext">
      <text>{{currentIndex < totalWords - 1 ? 'ä¸‹ä¸€ä¸ª' : 'å®Œæˆå­¦ä¹ '}}</text>
    </view>
  </view>

  <!-- å­¦ä¹ ç»Ÿè®¡æµ®å±‚ -->
  <view class="stats-overlay {{showStats ? 'show' : ''}}" bindtap="onHideStats">
    <view class="stats-content" catchtap="stopPropagation">
      <view class="stats-header">
        <text class="stats-title">å­¦ä¹ ç»Ÿè®¡</text>
        <text class="stats-close" bindtap="onHideStats">Ã—</text>
      </view>
      <view class="stats-body">
        <view class="stat-item">
          <text class="stat-label">å·²å­¦ä¹ </text>
          <text class="stat-value">{{studyStats.studied}}</text>
        </view>
        <view class="stat-item">
          <text class="stat-label">æŒæ¡</text>
          <text class="stat-value">{{studyStats.mastered}}</text>
        </view>
        <view class="stat-item">
          <text class="stat-label">éœ€å¤ä¹ </text>
          <text class="stat-value">{{studyStats.needReview}}</text>
        </view>
        <view class="stat-item">
          <text class="stat-label">æ­£ç¡®ç‡</text>
          <text class="stat-value">{{studyStats.accuracy}}%</text>
        </view>
      </view>
    </view>
  </view>

  <!-- å®Œæˆå­¦ä¹ å¼¹çª— -->
  <view class="complete-overlay {{showComplete ? 'show' : ''}}" bindtap="onHideComplete">
    <view class="complete-content" catchtap="stopPropagation">
      <view class="complete-header">
        <text class="complete-icon">ğŸ‰</text>
        <text class="complete-title">å­¦ä¹ å®Œæˆï¼</text>
      </view>
      <view class="complete-stats">
        <view class="complete-stat">
          <text class="complete-stat-value">{{studyStats.studied}}</text>
          <text class="complete-stat-label">ä¸ªå•è¯</text>
        </view>
        <view class="complete-stat">
          <text class="complete-stat-value">{{studyTime}}</text>
          <text class="complete-stat-label">åˆ†é’Ÿ</text>
        </view>
        <view class="complete-stat">
          <text class="complete-stat-value">{{studyStats.accuracy}}%</text>
          <text class="complete-stat-label">æ­£ç¡®ç‡</text>
        </view>
      </view>
      <view class="complete-actions">
        <view class="complete-btn secondary" bindtap="onRestart">
          <text>é‡æ–°å­¦ä¹ </text>
        </view>
        <view class="complete-btn primary" bindtap="onBackToDetail">
          <text>è¿”å›è¯¦æƒ…</text>
        </view>
      </view>
    </view>
  </view>
</view>